(function(){var c,b=[].indexOf||function(h){for(var g=0,f=this.length;g<f;g++){if(g in this&&this[g]===h){return g}}return -1},d=[].slice,e=function(f,g){return function(){return f.apply(g,arguments)}},a={}.hasOwnProperty;c=function(f){if(typeof exports==="object"&&typeof module==="object"){return f(require("jquery"))}else{if(typeof define==="function"&&define.amd){return define(["jquery"],f)}else{return f(jQuery)}}};c(function(g){var s,u,q,x,j,p,m,i,r,h,v,f,z,n,t,w,y,o;u=function(G,C,F){var E,A,D,B;G+="";A=G.split(".");D=A[0];B=A.length>1?F+A[1]:"";E=/(\d+)(\d{3})/;while(E.test(D)){D=D.replace(E,"$1"+C+"$2")}return D+B};v=function(A){var B;B={digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:"",showZero:false};A=g.extend(B,A);return function(D){var C;if(isNaN(D)||!isFinite(D)){return""}if(D===0&&!A.showZero){return""}C=u((A.scaler*D).toFixed(A.digitsAfterDecimal),A.thousandsSep,A.decimalSep);return""+A.prefix+C+A.suffix}};t=v();w=v({digitsAfterDecimal:0});y=v({digitsAfterDecimal:1,scaler:100,suffix:"%"});q={count:function(A){if(A==null){A=w}return function(){return function(C,D,B){return{count:0,push:function(){return this.count++},value:function(){return this.count},format:A}}}},countUnique:function(A){if(A==null){A=w}return function(C){var B;B=C[0];return function(E,F,D){return{uniq:[],push:function(G){var H;if(H=G[B],b.call(this.uniq,H)<0){return this.uniq.push(G[B])}},value:function(){return this.uniq.length},format:A,numInputs:B!=null?0:1}}}},listUnique:function(A){return function(C){var B;B=C[0];return function(E,F,D){return{uniq:[],push:function(G){var H;if(H=G[B],b.call(this.uniq,H)<0){return this.uniq.push(G[B])}},value:function(){return this.uniq.join(A)},format:function(G){return G},numInputs:B!=null?0:1}}}},sum:function(A){if(A==null){A=t}return function(C){var B;B=C[0];return function(E,F,D){return{sum:0,push:function(G){if(!isNaN(parseFloat(G[B]))){return this.sum+=parseFloat(G[B])}},value:function(){return this.sum},format:A,numInputs:B!=null?0:1}}}},min:function(A){if(A==null){A=t}return function(C){var B;B=C[0];return function(E,F,D){return{val:null,push:function(H){var I,G;G=parseFloat(H[B]);if(!isNaN(G)){return this.val=Math.min(G,(I=this.val)!=null?I:G)}},value:function(){return this.val},format:A,numInputs:B!=null?0:1}}}},max:function(A){if(A==null){A=t}return function(C){var B;B=C[0];return function(E,F,D){return{val:null,push:function(H){var I,G;G=parseFloat(H[B]);if(!isNaN(G)){return this.val=Math.max(G,(I=this.val)!=null?I:G)}},value:function(){return this.val},format:A,numInputs:B!=null?0:1}}}},average:function(A){if(A==null){A=t}return function(C){var B;B=C[0];return function(E,F,D){return{sum:0,len:0,push:function(G){if(!isNaN(parseFloat(G[B]))){this.sum+=parseFloat(G[B]);return this.len++}},value:function(){return this.sum/this.len},format:A,numInputs:B!=null?0:1}}}},sumOverSum:function(A){if(A==null){A=t}return function(B){var C,D;D=B[0],C=B[1];return function(F,G,E){return{sumNum:0,sumDenom:0,push:function(H){if(!isNaN(parseFloat(H[D]))){this.sumNum+=parseFloat(H[D])}if(!isNaN(parseFloat(H[C]))){return this.sumDenom+=parseFloat(H[C])}},value:function(){return this.sumNum/this.sumDenom},format:A,numInputs:(D!=null)&&(C!=null)?0:2}}}},sumOverSumBound80:function(B,A){if(B==null){B=true}if(A==null){A=t}return function(C){var D,E;E=C[0],D=C[1];return function(G,H,F){return{sumNum:0,sumDenom:0,push:function(I){if(!isNaN(parseFloat(I[E]))){this.sumNum+=parseFloat(I[E])}if(!isNaN(parseFloat(I[D]))){return this.sumDenom+=parseFloat(I[D])}},value:function(){var I;I=B?1:-1;return(0.821187207574908/this.sumDenom+this.sumNum/this.sumDenom+1.2815515655446004*I*Math.sqrt(0.410593603787454/(this.sumDenom*this.sumDenom)+(this.sumNum*(1-this.sumNum/this.sumDenom))/(this.sumDenom*this.sumDenom)))/(1+1.642374415149816/this.sumDenom)},format:A,numInputs:(E!=null)&&(D!=null)?0:2}}}},fractionOf:function(A,C,B){if(C==null){C="total"}if(B==null){B=y}return function(){var D;D=1<=arguments.length?d.call(arguments,0):[];return function(F,G,E){return{selector:{total:[[],[]],row:[G,[]],col:[[],E]}[C],inner:A.apply(null,D)(F,G,E),push:function(H){return this.inner.push(H)},format:B,value:function(){return this.inner.value()/F.getAggregator.apply(F,this.selector).inner.value()},numInputs:A.apply(null,D)().numInputs}}}}};x=(function(A){return{"Count":A.count(w),"Count Unique Values":A.countUnique(w),"List Unique Values":A.listUnique(", "),"Sum":A.sum(t),"Integer Sum":A.sum(w),"Average":A.average(t),"Minimum":A.min(t),"Maximum":A.max(t),"Sum over Sum":A.sumOverSum(t),"80% Upper Bound":A.sumOverSumBound80(true,t),"80% Lower Bound":A.sumOverSumBound80(false,t),"Sum as Fraction of Total":A.fractionOf(A.sum(),"total",y),"Sum as Fraction of Rows":A.fractionOf(A.sum(),"row",y),"Sum as Fraction of Columns":A.fractionOf(A.sum(),"col",y),"Count as Fraction of Total":A.fractionOf(A.count(),"total",y),"Count as Fraction of Rows":A.fractionOf(A.count(),"row",y),"Count as Fraction of Columns":A.fractionOf(A.count(),"col",y)}})(q);z={"Table":function(B,A){return f(B,A)},"Table Barchart":function(B,A){return g(f(B,A)).barchart()},"Heatmap":function(B,A){return g(f(B,A)).heatmap()},"Row Heatmap":function(B,A){return g(f(B,A)).heatmap("rowheatmap")},"Col Heatmap":function(B,A){return g(f(B,A)).heatmap("colheatmap")}};i={en:{aggregators:x,renderers:z,localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter results",totals:"Totals",subTotals:"subTotals",vs:"vs",by:"by"}}};r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];j=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];o=function(A){return("0"+A).substr(-2,2)};p={bin:function(A,B){return function(C){return C[A]-C[A]%B}},dateFormat:function(D,B,C,A,F){var E;if(C==null){C=false}if(A==null){A=r}if(F==null){F=j}E=C?"UTC":"";return function(G){var H;H=new Date(Date.parse(G[D]));if(isNaN(H)){return""}return B.replace(/%(.)/g,function(I,J){switch(J){case"y":return H["get"+E+"FullYear"]();case"m":return o(H["get"+E+"Month"]()+1);case"n":return A[H["get"+E+"Month"]()];case"d":return o(H["get"+E+"Date"]());case"w":return F[H["get"+E+"Day"]()];case"x":return H["get"+E+"Day"]();case"H":return o(H["get"+E+"Hours"]());case"M":return o(H["get"+E+"Minutes"]());case"S":return o(H["get"+E+"Seconds"]());default:return"%"+J}})}}};h=(function(A){return function(E,I){var H,D,F,G,J,C,B;C=/(\d+)|(\D+)/g;J=/\d/;B=/^0/;if(typeof E==="number"||typeof I==="number"){if(isNaN(E)){return 1}if(isNaN(I)){return -1}return E-I}H=String(E).toLowerCase();F=String(I).toLowerCase();if(H===F){return 0}if(!(J.test(H)&&J.test(F))){return(H>F?1:-1)}H=H.match(C);F=F.match(C);while(H.length&&F.length){D=H.shift();G=F.shift();if(D!==G){if(J.test(D)&&J.test(G)){return D.replace(B,".0")-G.replace(B,".0")}else{return(D>G?1:-1)}}}return H.length-F.length}})(this);n=function(B){var D,C,A;C={};for(D in B){A=B[D];C[A]=D}return function(F,E){if((C[F]!=null)&&(C[E]!=null)){return C[F]-C[E]}else{if(C[F]!=null){return -1}else{if(C[E]!=null){return 1}else{return h(F,E)}}}}};m=function(C,A){var B;B=C(A);if(g.isFunction(B)){return B}else{return h}};s=(function(){function A(B,C){this.getAggregator=e(this.getAggregator,this);this.getRowKeys=e(this.getRowKeys,this);this.getColKeys=e(this.getColKeys,this);this.sortKeys=e(this.sortKeys,this);this.arrSort=e(this.arrSort,this);this.aggregator=C.aggregator;this.aggregatorName=C.aggregatorName;this.colAttrs=C.cols;this.rowAttrs=C.rows;this.valAttrs=C.vals;this.sorters=C.sorters;this.tree={};this.rowKeys=[];this.colKeys=[];this.rowTotals={};this.colTotals={};this.allTotal=this.aggregator(this,[],[]);this.sorted=false;A.forEachRecord(B,C.derivedAttributes,(function(D){return function(E){if(C.filter(E)){return D.processRecord(E)}}})(this))}A.forEachRecord=function(N,P,L){var O,E,J,H,F,D,G,K,B,I,C,M;if(g.isEmptyObject(P)){O=L}else{O=function(Q){var S,T,R;for(S in P){R=P[S];Q[S]=(T=R(Q))!=null?T:Q[S]}return L(Q)}}if(g.isFunction(N)){return N(O)}else{if(g.isArray(N)){if(g.isArray(N[0])){I=[];for(J in N){if(!a.call(N,J)){continue}E=N[J];if(!(J>0)){continue}K={};B=N[0];for(H in B){if(!a.call(B,H)){continue}F=B[H];K[F]=E[H]}I.push(O(K))}return I}else{C=[];for(D=0,G=N.length;D<G;D++){K=N[D];C.push(O(K))}return C}}else{if(N instanceof jQuery){M=[];g("thead > tr > th",N).each(function(Q){return M.push(g(this).text())});return g("tbody > tr",N).each(function(Q){K={};g("td",this).each(function(R){return K[M[R]]=g(this).text()});return O(K)})}else{throw new Error("unknown input format")}}}};A.convertToArray=function(C){var B;B=[];A.forEachRecord(C,{},function(D){return B.push(D)});return B};A.prototype.arrSort=function(C){var B,D;D=(function(){var E,F,G;G=[];for(E=0,F=C.length;E<F;E++){B=C[E];G.push(m(this.sorters,B))}return G}).call(this);return function(F,E){var H,G,I;for(G in D){if(!a.call(D,G)){continue}I=D[G];H=I(F[G],E[G]);if(H!==0){return H}}return 0}};A.prototype.sortKeys=function(){if(!this.sorted){this.sorted=true;this.rowKeys.sort(this.arrSort(this.rowAttrs));return this.colKeys.sort(this.arrSort(this.colAttrs))}};A.prototype.getColKeys=function(){this.sortKeys();return this.colKeys};A.prototype.getRowKeys=function(){this.sortKeys();return this.rowKeys};A.prototype.processRecord=function(I){var H,O,J,E,G,F,D,C,M,L,K,B,N;H=[];B=[];C=this.colAttrs;for(E=0,G=C.length;E<G;E++){N=C[E];H.push((M=I[N])!=null?M:"null")}L=this.rowAttrs;for(D=0,F=L.length;D<F;D++){N=L[D];B.push((K=I[N])!=null?K:"null")}J=B.join(String.fromCharCode(0));O=H.join(String.fromCharCode(0));this.allTotal.push(I);if(B.length!==0){if(!this.rowTotals[J]){this.rowKeys.push(B);this.rowTotals[J]=this.aggregator(this,B,[])}this.rowTotals[J].push(I)}if(H.length!==0){if(!this.colTotals[O]){this.colKeys.push(H);this.colTotals[O]=this.aggregator(this,[],H)}this.colTotals[O].push(I)}if(H.length!==0&&B.length!==0){if(!this.tree[J]){this.tree[J]={}}if(!this.tree[J][O]){this.tree[J][O]=this.aggregator(this,B,H)}return this.tree[J][O].push(I)}};A.prototype.getAggregator=function(F,D){var B,E,C;C=F.join(String.fromCharCode(0));E=D.join(String.fromCharCode(0));if(F.length===0&&D.length===0){B=this.allTotal}else{if(F.length===0){B=this.colTotals[E]}else{if(D.length===0){B=this.rowTotals[C]}else{B=this.tree[C][E]}}}return B!=null?B:{value:(function(){return null}),format:function(){return""}}};return A})();g.pivotUtilities={aggregatorTemplates:q,aggregators:x,renderers:z,derivers:p,locales:i,naturalSort:h,numberFormat:v,sortAs:n,PivotData:s};f=function(O,M){var S,X,Y,Z,D,J,V,T,P,K,W,L,aa,U,G,F,R,A,N,ab,I,Q;J={localeStrings:{totals:"Totals"},aggregateDeep:2};M=g.extend(J,M);Y=O.colAttrs;W=O.rowAttrs;aa=O.getRowKeys();D=O.getColKeys();M.aggregateDeep=W.length-1;K=document.createElement("table");K.className="pvtTable";Q=function(ak,ai){var ag,ad,ac,al,af,aj;ag=document.createElement("tr");af=document.createElement("th");af.className="pvtTotalLabel pvtRowLabel";af.innerHTML=M.localeStrings.subTotals;af.setAttribute("colspan",W.length-ai);ag.appendChild(af);var ah=[];ah.push(aa[ak]);while(ak>=1){C="";B="";for(ki=ai;ki>=0;ki--){C+=aa[ak][ki];B+=aa[ak-1][ki]}if(C==B){ah.push(aa[ak-1])}else{break}ak--}for(ci in D){if(!a.call(D,ci)){continue}ac=D[ci];al=0;for(ri in ah){if(!a.call(ah,ri)){continue}ad=ah[ri];S=O.getAggregator(ad,ac);al+=S.value()}aj=document.createElement("td");aj.className="pvtTotalLabel pvtVal rowSubTotal col"+ci;aj.textContent=al;aj.setAttribute("data-value",al);ag.appendChild(aj)}var ae=0;g(ag).children("td").each(function(){var am=parseInt(g(this).text());ae+=(isNaN(am)?0:am)});aj=document.createElement("td");aj.className="pvtTotalLabel pvtTotal rowTotal";aj.textContent=ae;aj.setAttribute("data-value",ae);aj.setAttribute("data-for","subTotalRow");ag.appendChild(aj);return ag};U=function(ai,ah,ag){var af,aj,ac,ae,ad,ak,al,am;if(ah!==0){ae=true;for(am=af=0,ad=ag;0<=ad?af<=ad:af>=ad;am=0<=ad?++af:--af){if(ai[ah-1][am]!==ai[ah][am]){ae=false}}if(ae){return -1}}aj=0;while(ah+aj<ai.length){al=false;for(am=ac=0,ak=ag;0<=ak?ac<=ak:ac>=ak;am=0<=ak?++ac:--ac){if(ai[ah][am]!==ai[ah+aj][am]){al=true}}if(al){break}aj++}return aj};spanDeep=function(ad,ag,af,ac){var ah=ad[ag];var ae=0;var aj="",ai="";if(af<M.aggregateDeep&&af<ah.length){ae=1}for(di=af;di<M.aggregateDeep&&di<ah.length;di++){for(ri=ag+1;ri<ag+ac&&ri<ad.length;ri++){aj="";ai="";for(ki=di;ki>=0;ki--){aj+=ad[ri-1][ki];ai+=ad[ri][ki]}if(aj!=ai){ae++}}}ae+=(M.aggregateDeep-1-af);return ae+ac};for(T in Y){if(!a.call(Y,T)){continue}X=Y[T];A=document.createElement("tr");if(parseInt(T)===0&&W.length!==0){F=document.createElement("th");F.setAttribute("colspan",W.length);F.setAttribute("rowspan",Y.length);A.appendChild(F)}F=document.createElement("th");F.className="pvtAxisLabel";F.textContent=X;A.appendChild(F);for(V in D){if(!a.call(D,V)){continue}Z=D[V];I=U(D,parseInt(V),parseInt(T));if(I!==-1){F=document.createElement("th");F.className="pvtColLabel";F.textContent=Z[T];F.setAttribute("colspan",I);if(parseInt(T)===Y.length-1&&W.length!==0){F.setAttribute("rowspan",2)}A.appendChild(F)}}if(parseInt(T)===0){F=document.createElement("th");F.className="pvtTotalLabel";F.innerHTML=M.localeStrings.totals;F.setAttribute("rowspan",Y.length+(W.length===0?0:1));A.appendChild(F)}K.appendChild(A)}if(W.length!==0){A=document.createElement("tr");for(V in W){if(!a.call(W,V)){continue}P=W[V];F=document.createElement("th");F.className="pvtAxisLabel";F.textContent=P;A.appendChild(F)}F=document.createElement("th");if(Y.length===0){F.className="pvtTotalLabel";F.innerHTML=M.localeStrings.totals}A.appendChild(F);K.appendChild(A)}for(V in aa){if(!a.call(aa,V)){continue}L=aa[V];A=document.createElement("tr");var E=0;for(T in L){if(!a.call(L,T)){continue}N=L[T];I=U(aa,parseInt(V),parseInt(T));var H=0,C="",B="";if(I!==-1){if(V>0&&T<M.aggregateDeep&&E++<=0){for(k=M.aggregateDeep-1;k>=0;k--){C="";B="";for(ki=k;ki>=0;ki--){C+=aa[V][ki];B+=aa[V-1][ki]}if(C!=B){K.appendChild(Q(V-1,k))}}}F=document.createElement("th");F.className="pvtRowLabel";F.textContent=N;deep1=spanDeep(aa,parseInt(V),parseInt(T),I);if(deep1>1){F.setAttribute("rowspan",deep1)}if(parseInt(T)===W.length-1&&Y.length!==0){F.setAttribute("colspan",2)}A.appendChild(F)}}for(T in D){if(!a.call(D,T)){continue}Z=D[T];S=O.getAggregator(L,Z);ab=S.value();G=document.createElement("td");G.className="pvtVal row"+V+" col"+T;G.textContent=S.format(ab);G.setAttribute("data-value",ab);A.appendChild(G)}R=O.getAggregator(L,[]);ab=R.value();G=document.createElement("td");G.className="pvtTotal rowTotal";G.textContent=R.format(ab);G.setAttribute("data-value",ab);G.setAttribute("data-for","row"+V);A.appendChild(G);K.appendChild(A)}for(l=M.aggregateDeep-1;l>=0;l--){K.appendChild(Q(aa.length-1,l))}A=document.createElement("tr");F=document.createElement("th");F.className="pvtTotalLabel";F.innerHTML=M.localeStrings.totals;F.setAttribute("colspan",W.length+(Y.length===0?0:1));A.appendChild(F);for(T in D){if(!a.call(D,T)){continue}Z=D[T];R=O.getAggregator([],Z);ab=R.value();G=document.createElement("td");G.className="pvtTotal colTotal";G.textContent=R.format(ab);G.setAttribute("data-value",ab);G.setAttribute("data-for","col"+T);A.appendChild(G)}R=O.getAggregator([],[]);ab=R.value();G=document.createElement("td");G.className="pvtGrandTotal";G.textContent=R.format(ab);G.setAttribute("data-value",ab);A.appendChild(G);K.appendChild(A);K.setAttribute("data-numrows",aa.length);K.setAttribute("data-numcols",D.length);return K};g.fn.pivot=function(H,A){var B,D,F,E,C,I,G;B={cols:[],rows:[],vals:[],filter:function(){return true},aggregator:q.count()(),aggregatorName:"Count",sorters:function(){},derivedAttributes:{},renderer:f,rendererOptions:null,localeStrings:i.en.localeStrings};A=g.extend(B,A);I=null;try{C=new s(H,A);try{I=A.renderer(C,A.rendererOptions)}catch(F){D=F;if(typeof console!=="undefined"&&console!==null){console.error(D.stack)}I=g("<span>").html(A.localeStrings.renderError)}}catch(E){D=E;if(typeof console!=="undefined"&&console!==null){console.error(D.stack)}I=g("<span>").html(A.localeStrings.computeError)}G=this[0];while(G.hasChildNodes()){G.removeChild(G.lastChild)}return this.append(I)};g.fn.pivotUI=function(A,Y,ae,O){var ar,H,af,G,aq,J,W,ao,S,ap,V,an,P,am,al,E,D,C,B,aj,ah,T,U,ag,ad,M,L,K,I,at,N,Z,R,F,Q,ak,ai,X,ac,aa,ab;if(ae==null){ae=false}if(O==null){O="en"}if(i[O]==null){O="en"}W={derivedAttributes:{},aggregators:i[O].aggregators,renderers:i[O].renderers,hiddenAttributes:[],menuLimit:200,cols:[],rows:[],vals:[],exclusions:{},inclusions:{},unusedAttrsVertical:85,autoSortUnusedAttrs:false,rendererOptions:{localeStrings:i[O].localeStrings},onRefresh:null,filter:function(){return true},sorters:function(){},localeStrings:i[O].localeStrings};ap=this.data("pivotUIOptions");if((ap==null)||ae){T=g.extend(W,Y)}else{T=ap}try{A=s.convertToArray(A);Q=(function(){var av,au;av=A[0];au=[];for(am in av){if(!a.call(av,am)){continue}au.push(am)}return au})();ad=T.derivedAttributes;for(aq in ad){if(!a.call(ad,aq)){continue}if((b.call(Q,aq)<0)){Q.push(aq)}}G={};for(al=0,E=Q.length;al<E;al++){ab=Q[al];G[ab]={}}s.forEachRecord(A,T.derivedAttributes,function(au){var ax,aw,av;aw=[];for(am in au){if(!a.call(au,am)){continue}av=au[am];if(!(T.filter(au))){continue}if(av==null){av="null"}if((ax=G[am])[av]==null){ax[av]=0}aw.push(G[am][av]++)}return aw});X=g("<table>",{"class":"pvtUi"}).attr("cellpadding",5);R=g("<td>");Z=g("<select>").addClass("pvtRenderer").appendTo(R).bind("change",function(){return at()});M=T.renderers;for(ab in M){if(!a.call(M,ab)){continue}g("<option>").val(ab).html(ab).appendTo(Z)}J=g("<td>").addClass("pvtAxisContainer pvtUnused");F=(function(){var au,aw,av;av=[];for(aw=0,au=Q.length;aw<au;aw++){aq=Q[aw];if(b.call(T.hiddenAttributes,aq)<0){av.push(aq)}}return av})();aa=false;if(T.unusedAttrsVertical==="auto"){ac=120}else{ac=parseInt(T.unusedAttrsVertical)}if(!isNaN(ac)){af=0;for(aj=0,D=F.length;aj<D;aj++){ar=F[aj];af+=ar.length}aa=af>ac}if(T.unusedAttrsVertical===true||aa){J.addClass("pvtVertList")}else{J.addClass("pvtHorizList")}V=function(aE){var aH,az,av,ay,aB,aF,aJ,ax,au,aD,aI,aA,aC,aG,aw;aJ=(function(){var aK;aK=[];for(am in G[aE]){aK.push(am)}return aK})();aF=false;aw=g("<div>").addClass("pvtFilterBox").hide();aw.append(g("<h4>").text(aE+" ("+aJ.length+")"));if(aJ.length>T.menuLimit){aw.append(g("<p>").html(T.localeStrings.tooMany))}else{az=g("<p>").appendTo(aw);az.append(g("<button>",{type:"button"}).html(T.localeStrings.selectAll).bind("click",function(){return aw.find("input:visible").prop("checked",true)}));az.append(g("<button>",{type:"button"}).html(T.localeStrings.selectNone).bind("click",function(){return aw.find("input:visible").prop("checked",false)}));az.append(g("<br>"));az.append(g("<input>",{type:"text",placeholder:T.localeStrings.filterResults,"class":"pvtSearch"}).bind("keyup",function(){var aK;aK=g(this).val().toLowerCase();return aw.find(".pvtCheckContainer p").each(function(){var aL;aL=g(this).text().toLowerCase().indexOf(aK);if(aL!==-1){return g(this).show()}else{return g(this).hide()}})}));av=g("<div>").addClass("pvtCheckContainer").appendTo(aw);aD=aJ.sort(m(T.sorters,aE));for(au=0,ax=aD.length;au<ax;au++){am=aD[au];aG=G[aE][am];ay=g("<label>");aB=false;if(T.inclusions[aE]){aB=(b.call(T.inclusions[aE],am)<0)}else{if(T.exclusions[aE]){aB=(b.call(T.exclusions[aE],am)>=0)}}aF||(aF=aB);g("<input>").attr("type","checkbox").addClass("pvtFilter").attr("checked",!aB).data("filter",[aE,am]).appendTo(ay);ay.append(g("<span>").text(am));ay.append(g("<span>").text(" ("+aG+")"));av.append(g("<p>").append(ay))}}aC=function(){var aK;aK=aw.find("[type='checkbox']").length-aw.find("[type='checkbox']:checked").length;if(aK>0){aH.addClass("pvtFilteredAttribute")}else{aH.removeClass("pvtFilteredAttribute")}if(aJ.length>T.menuLimit){return aw.toggle()}else{return aw.toggle(0,at)}};g("<p>").appendTo(aw).append(g("<button>",{type:"button"}).text("OK").bind("click",aC));aI=function(aN){var aM,aL,aK;aK=g(aN.currentTarget).position(),aM=aK.left,aL=aK.top;aw.css({left:aM+10,top:aL+10}).toggle();aw.find(".pvtSearch").val("");return aw.find(".pvtCheckContainer p").show()};aA=g("<span>").addClass("pvtTriangle").html(" &#x25BE;").bind("click",aI);aH=g("<li>").addClass("axis_"+an).append(g("<span>").addClass("pvtAttr").text(aE).data("attrName",aE).append(aA));if(aF){aH.addClass("pvtFilteredAttribute")}J.append(aH).append(aw);return aH.bind("dblclick",aI)};for(an in F){if(!a.call(F,an)){continue}aq=F[an];V(aq)}ak=g("<tr>").appendTo(X);H=g("<select>").addClass("pvtAggregator").bind("change",function(){return at()});L=T.aggregators;for(ab in L){if(!a.call(L,ab)){continue}H.append(g("<option>").val(ab).html(ab))}g("<td>").addClass("pvtVals").appendTo(ak).append(H).append(g("<br>"));g("<td>").addClass("pvtAxisContainer pvtHorizList pvtCols").appendTo(ak);ai=g("<tr>").appendTo(X);ai.append(g("<td>").addClass("pvtAxisContainer pvtRows").attr("valign","top"));U=g("<td>").attr("valign","top").addClass("pvtRendererArea").appendTo(ai);if(T.unusedAttrsVertical===true||aa){X.find("tr:nth-child(1)").prepend(R);X.find("tr:nth-child(2)").prepend(J)}else{X.prepend(g("<tr>").append(R).append(J))}this.html(X);K=T.cols;for(ah=0,C=K.length;ah<C;ah++){ab=K[ah];this.find(".pvtCols").append(this.find(".axis_"+(g.inArray(ab,F))))}I=T.rows;for(ag=0,B=I.length;ag<B;ag++){ab=I[ag];this.find(".pvtRows").append(this.find(".axis_"+(g.inArray(ab,F))))}if(T.aggregatorName!=null){this.find(".pvtAggregator").val(T.aggregatorName)}if(T.rendererName!=null){this.find(".pvtRenderer").val(T.rendererName)}P=true;N=(function(au){return function(){var aA,aB,aI,aw,av,aC,az,aF,ay,ax,aJ,aG,aH,aE,aD;aG={derivedAttributes:T.derivedAttributes,localeStrings:T.localeStrings,rendererOptions:T.rendererOptions,sorters:T.sorters,cols:[],rows:[]};aC=(ay=T.aggregators[H.val()]([])().numInputs)!=null?ay:0;aD=[];au.find(".pvtRows li span.pvtAttr").each(function(){return aG.rows.push(g(this).data("attrName"))});au.find(".pvtCols li span.pvtAttr").each(function(){return aG.cols.push(g(this).data("attrName"))});au.find(".pvtVals select.pvtAttrDropdown").each(function(){if(aC===0){return g(this).remove()}else{aC--;if(g(this).val()!==""){return aD.push(g(this).val())}}});if(aC!==0){aF=au.find(".pvtVals");for(ab=aJ=0,ax=aC;0<=ax?aJ<ax:aJ>ax;ab=0<=ax?++aJ:--aJ){av=g("<select>").addClass("pvtAttrDropdown").append(g("<option>")).bind("change",function(){return at()});for(aH=0,aw=F.length;aH<aw;aH++){aA=F[aH];av.append(g("<option>").val(aA).text(aA))}aF.append(av)}}if(P){aD=T.vals;an=0;au.find(".pvtVals select.pvtAttrDropdown").each(function(){g(this).val(aD[an]);return an++});P=false}aG.aggregatorName=H.val();aG.vals=aD;aG.aggregator=T.aggregators[H.val()](aD);aG.renderer=T.renderers[Z.val()];aB={};au.find("input.pvtFilter").not(":checked").each(function(){var aK;aK=g(this).data("filter");if(aB[aK[0]]!=null){return aB[aK[0]].push(aK[1])}else{return aB[aK[0]]=[aK[1]]}});aI={};au.find("input.pvtFilter:checked").each(function(){var aK;aK=g(this).data("filter");if(aB[aK[0]]!=null){if(aI[aK[0]]!=null){return aI[aK[0]].push(aK[1])}else{return aI[aK[0]]=[aK[1]]}}});aG.filter=function(aK){var aM,aL;if(!T.filter(aK)){return false}for(am in aB){aM=aB[am];if(aL=""+aK[am],b.call(aM,aL)>=0){return false}}return true};U.pivot(A,aG);az=g.extend(T,{cols:aG.cols,rows:aG.rows,vals:aD,exclusions:aB,inclusions:aI,inclusionsInfo:aI,aggregatorName:H.val(),rendererName:Z.val()});au.data("pivotUIOptions",az);if(T.autoSortUnusedAttrs){aE=au.find("td.pvtUnused.pvtAxisContainer");g(aE).children("li").sort(function(aL,aK){return h(g(aL).text(),g(aK).text())}).appendTo(aE)}U.css("opacity",1);if(T.onRefresh!=null){return T.onRefresh(az)}}})(this);at=(function(au){return function(){U.css("opacity",0.5);return setTimeout(N,10)}})(this);at();this.find(".pvtAxisContainer").sortable({update:function(av,au){if(au.sender==null){return at()}},connectWith:this.find(".pvtAxisContainer"),items:"li",placeholder:"pvtPlaceholder"})}catch(S){ao=S;if(typeof console!=="undefined"&&console!==null){console.error(ao.stack)}this.html(T.localeStrings.uiRenderError)}return this};g.fn.heatmap=function(K){var I,J,F,E,D,B,C,G,A,H;if(K==null){K="heatmap"}G=this.data("numrows");C=this.data("numcols");I=function(M,N,L){var O;O=(function(){switch(M){case"red":return function(P){return"ff"+P+P};case"green":return function(P){return P+"ff"+P};case"blue":return function(P){return""+P+P+"ff"}}})();return function(Q){var R,P;P=255-Math.round(255*(Q-N)/(L-N));R=P.toString(16).split(".")[0];if(R.length===1){R=0+R}return O(R)}};J=(function(L){return function(Q,P){var O,M,N;M=function(R){return L.find(Q).each(function(){var S;S=g(this).data("value");if((S!=null)&&isFinite(S)){return R(S,g(this))}})};N=[];M(function(R){return N.push(R)});O=I(P,Math.min.apply(Math,N),Math.max.apply(Math,N));return M(function(R,S){return S.css("background-color","#"+O(R))})}})(this);switch(K){case"heatmap":J(".pvtVal","red");break;case"rowheatmap":for(F=D=0,A=G;0<=A?D<A:D>A;F=0<=A?++D:--D){J(".pvtVal.row"+F,"red")}break;case"colheatmap":for(E=B=0,H=C;0<=H?B<H:B>H;E=0<=H?++B:--B){J(".pvtVal.col"+E,"red")}}J(".pvtTotal.rowTotal","red");J(".pvtTotal.colTotal","red");return this};return g.fn.barchart=function(){var B,C,A,F,E,D;E=this.data("numrows");F=this.data("numcols");B=(function(G){return function(K){var I,H,L,J;I=function(M){return G.find(K).each(function(){var N;N=g(this).data("value");if((N!=null)&&isFinite(N)){return M(N,g(this))}})};J=[];I(function(M){return J.push(M)});H=Math.max.apply(Math,J);L=function(M){return 100*M/(1.4*H)};return I(function(M,N){var O,P;O=N.text();P=g("<div>").css({"position":"relative","height":"55px"});P.append(g("<div>").css({"position":"absolute","bottom":0,"left":0,"right":0,"height":L(M)+"%","background-color":"gray"}));P.append(g("<div>").text(O).css({"position":"relative","padding-left":"5px","padding-right":"5px"}));return N.css({"padding":0,"padding-top":"5px","text-align":"center"}).html(P)})}})(this);for(C=A=0,D=E;0<=D?A<D:A>D;C=0<=D?++A:--A){B(".pvtVal.row"+C)}B(".pvtTotal.colTotal");return this}})}).call(this);